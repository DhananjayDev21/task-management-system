<h4 mat-dialog-title>{{ data ? 'Edit Task' : 'Create Task' }}</h4>

<mat-dialog-content>
    <form [formGroup]="taskForm">

        <mat-form-field appearance="outline" class="full-width">
            <mat-label>Title</mat-label>
            <input matInput formControlName="title" />
        </mat-form-field>

        <mat-form-field appearance="outline" class="full-width">
            <mat-label>Description</mat-label>
            <textarea matInput formControlName="description"></textarea>
        </mat-form-field>

        <mat-form-field appearance="outline" class="full-width">
            <mat-label>Status</mat-label>
            <mat-select formControlName="status">
                <mat-option *ngFor="let s of statuses" [value]="s">{{ s }}</mat-option>
            </mat-select>
        </mat-form-field>

        <mat-form-field appearance="outline" class="full-width">
            <mat-label>Priority</mat-label>
            <mat-select formControlName="priority">
                <mat-option *ngFor="let p of priorities" [value]="p">{{ p }}</mat-option>
            </mat-select>
        </mat-form-field>

        <mat-form-field appearance="outline" class="full-width">
            <mat-label>Category</mat-label>
            <mat-select formControlName="category">
                <mat-option *ngFor="let c of categories" [value]="c">{{ c }}</mat-option>
            </mat-select>
        </mat-form-field>

        <mat-form-field appearance="outline" class="full-width">
            <mat-label>Start Date</mat-label>
            <input matInput [matDatepicker]="startPicker" formControlName="startDate" />
            <mat-datepicker-toggle matSuffix [for]="startPicker"></mat-datepicker-toggle>
            <mat-datepicker #startPicker></mat-datepicker>
        </mat-form-field>

        <mat-form-field appearance="outline" class="full-width">
            <mat-label>Start Time</mat-label>
            <input matInput type="time" formControlName="startTime" />
        </mat-form-field>

        <mat-form-field appearance="outline" class="full-width">
            <mat-label>Due Date</mat-label>
            <input matInput [matDatepicker]="duePicker" formControlName="dueDate" />
            <mat-datepicker-toggle matSuffix [for]="duePicker"></mat-datepicker-toggle>
            <mat-datepicker #duePicker></mat-datepicker>
        </mat-form-field>


        <mat-form-field appearance="outline" class="full-width">
            <mat-label>Due Time</mat-label>
            <input matInput type="time" formControlName="dueTime" />
        </mat-form-field>


        <label>Tags</label>
        <div class="tags-container">
            @for (tag of tags.controls; track $index) {
            <div class="tag">
                {{ tag.value }} <span (click)="removeTag($index)">Ã—</span>
            </div>
            }
            <input #tagInput type="text" placeholder="Add tag"
                (keydown.enter)="addTag(tagInput); $event.preventDefault()" />
        </div>
    </form>
</mat-dialog-content>

<mat-divider></mat-divider>

<mat-dialog-actions align="end">
    <button mat-button (click)="closeDialog()">Cancel</button>
    <button mat-flat-button color="primary" (click)="submitTask()">Save</button>
</mat-dialog-actions>